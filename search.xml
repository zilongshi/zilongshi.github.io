<?xml version="1.0" encoding="utf-8"?>
<search>
  
    
    <entry>
      <title><![CDATA[Linux下修复Sublime Text 3无法使用Fcitx搜狗拼音的方法]]></title>
      <url>%2F2016%2F12%2F13%2Ffix-sublime-cannot-using-fcitx%2F</url>
      <content type="text"><![CDATA[通过启动sublime text 3时指定LD_PRELOAD来修复ubuntu 16.04中sublime text 3不支持fcitx中文输入法的问题。Sublime Text 3安装路径为/opt/sublime_text/ 1.安装C/C++的编译环境和gtk libgtk2.0-devsudo apt-get install build-essential sudo apt-get install libgtk2.0-dev 2.编译共享内库gcc -shared -o libsublime-imfix.so sublime-imfix.c `pkg-config --libs --cflags gtk+-2.0` -fPIC sublime-imfix.c代码由OSChina Wuu原帖给出，搬运如下：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778/*sublime-imfix.cUse LD_PRELOAD to interpose some function to fix sublime input method support for linux.By Cjacker Huang &lt;jianzhong.huang at i-soft.com.cn&gt;gcc -shared -o libsublime-imfix.so sublime_imfix.c `pkg-config --libs --cflags gtk+-2.0` -fPICLD_PRELOAD=./libsublime-imfix.so sublime_text*/#include &lt;gtk/gtk.h&gt;#include &lt;gdk/gdkx.h&gt;typedef GdkSegment GdkRegionBox;struct _GdkRegion&#123; long size; long numRects; GdkRegionBox *rects; GdkRegionBox extents;&#125;;GtkIMContext *local_context;voidgdk_region_get_clipbox (const GdkRegion *region, GdkRectangle *rectangle)&#123; g_return_if_fail (region != NULL); g_return_if_fail (rectangle != NULL); rectangle-&gt;x = region-&gt;extents.x1; rectangle-&gt;y = region-&gt;extents.y1; rectangle-&gt;width = region-&gt;extents.x2 - region-&gt;extents.x1; rectangle-&gt;height = region-&gt;extents.y2 - region-&gt;extents.y1; GdkRectangle rect; rect.x = rectangle-&gt;x; rect.y = rectangle-&gt;y; rect.width = 0; rect.height = rectangle-&gt;height; //The caret width is 2; //Maybe sometimes we will make a mistake, but for most of the time, it should be the caret. if(rectangle-&gt;width == 2 &amp;&amp; GTK_IS_IM_CONTEXT(local_context)) &#123; gtk_im_context_set_cursor_location(local_context, rectangle); &#125;&#125;//this is needed, for example, if you input something in file dialog and return back the edit area//context will lost, so here we set it again.static GdkFilterReturn event_filter (GdkXEvent *xevent, GdkEvent *event, gpointer im_context)&#123; XEvent *xev = (XEvent *)xevent; if(xev-&gt;type == KeyRelease &amp;&amp; GTK_IS_IM_CONTEXT(im_context)) &#123; GdkWindow * win = g_object_get_data(G_OBJECT(im_context),"window"); if(GDK_IS_WINDOW(win)) gtk_im_context_set_client_window(im_context, win); &#125; return GDK_FILTER_CONTINUE;&#125;void gtk_im_context_set_client_window (GtkIMContext *context, GdkWindow *window)&#123; GtkIMContextClass *klass; g_return_if_fail (GTK_IS_IM_CONTEXT (context)); klass = GTK_IM_CONTEXT_GET_CLASS (context); if (klass-&gt;set_client_window) klass-&gt;set_client_window (context, window); if(!GDK_IS_WINDOW (window)) return; g_object_set_data(G_OBJECT(context),"window",window); int width = gdk_window_get_width(window); int height = gdk_window_get_height(window); if(width != 0 &amp;&amp; height !=0) &#123; gtk_im_context_focus_in(context); local_context = context; &#125; gdk_window_add_filter (window, event_filter, context); &#125; 3.将libsublime-imfix.so移动到/usr/lib/sudo mv libsublime-imfix.so /usr/lib/ 4.启动 Sublime Text 3LD_PRELOAD=/usr/lib/libsublime-imfix.so subl 即可运行Fcitx的搜狗拼音输入法了。 为了避免每次都要在终端里面使用命令启动sublime text 3，还要通过修改subl以及sublime-text.desktop达到统一的启动效果。 1.打开sublime-text-3sudo vim /usr/bin/subl 2.修改subl为以下内容#!/bin/bash LD_PRELOAD=/usr/lib/libsublime-imfix.so /opt/sublime_text/sublime_text &quot;$@&quot; 这样就能使用subl等命令启动 3.打开sublime-text.desktopsudo vim /usr/share/applications/sublime-text.desktop 4.修改sublime-text.desktop将 Exec=/usr/bin/sublime-text-3 %F 修改为 Exec=bash -c &apos;LD_PRELOAD=/usr/lib/libsublime-imfix.so /usr/bin/sublime-text-3&apos; %F 将 Exec=/usr/bin/sublime-text-3 --new-window 修改为 Exec=bash -c &apos;LD_PRELOAD=/usr/lib/libsublime-imfix.so /usr/bin/sublime-text-3&apos; --new-window 感谢Wuu原帖给出解决方案。]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>%2F2016%2F12%2F12%2Fhello-world%2F</url>
      <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
    </entry>

    
  
  
</search>
